ALTER TABLE EMPRESA ADD EMP_CHAVE_PIX VARCHAR(40);

ALTER TABLE PARAMETRO ADD PAR_OBSERVACAO BLOB SUB_TYPE 0 SEGMENT SIZE 80;

COMMIT;

UPDATE OR INSERT INTO PARAMETRO 
    (PAR_CODIGO, GP_CODIGO, PAR_DESCRICAO, PAR_TIPO_REGISTRO, PAR_MASCARA, PAR_USO, PAR_VALOR, PAR_OBSERVACAO)
VALUES 
    (49, 0, 'TIPO DE IMPRESSÃO O.P', '2', NULL, 0, 1, CAST('A configuração desse parâmetro define a preferência de tipo de impressão da O.P., com base em 4 opções: 1 - Imprimir Sem Valores, 2 - Imprimir Valores da O.P e 3 - Imprimir Valores da O.P e dos Processos, opção será marcada automaticamente ao abrir o formulário de opções de impressão, e a 4 opção para o modo simples de impressão.' AS BLOB SUB_TYPE 0 SEGMENT SIZE 80))
MATCHING (PAR_CODIGO);

UPDATE or INSERT INTO FORMULARIO(FORM_CODIGO, FORM_NOME, FORM_TIPO, MDL_CODIGO)
               VALUES(98,'Controle Financeiro','F',1);

UPDATE or INSERT INTO FORM_ACAO(FORM_CODIGO, ACAO_CODIGO)
               VALUES(98,1);

UPDATE or INSERT INTO FORM_ACAO_PERFIL(FORM_CODIGO, ACAO_CODIGO,PERF_CODIGO)
               VALUES(98,1,1);

COMMIT;

ALTER TABLE FUNCIONARIO ADD FUN_TIPO VARCHAR(1);

COMMIT;

SET TERM ^ ;

CREATE OR ALTER PROCEDURE SELECT_RENEG_CONTA_PAGAR (
    CODE_TIPO_DOC INTEGER)
RETURNS (
    CPR INTEGER,
    PCP INTEGER,
    CODE_DOC INTEGER,
    CODE_EMP INTEGER,
    DATA_COMPRA DATE,
    DOCUMENTO VARCHAR(15),
    VENCIMENTO DATE,
    VALOR DOUBLE PRECISION,
    TIPO_DOC VARCHAR(50),
    CUSTO VARCHAR(50),
    VALOR_PAGO DOUBLE PRECISION,
    SALDO_DEVEDOR DOUBLE PRECISION)
AS
BEGIN
  FOR
    SELECT
        CPR.CPR_CODIGO,
        PCP.PCP_CODIGO,
        CPR.EMP_CODIGO,
        CAST(CPR.CPR_DATA_CADASTRO AS DATE),
        PCP.PCP_DOCUMENTO,
        PCP.PCP_DATA_VENCIMENTO,
        PCP.PCP_VALOR_PARCELA,
        PCP.TD_CODIGO,
        TD.TD_NOME,
        C.CC_NOME
    FROM
        CONTA_PAGAR CPR,
        PARCELA_CONTA_PAGAR PCP,
        TIPO_DOCUMENTO TD,
        CENTRO_CUSTO C
    WHERE
        CPR.CPR_CODIGO = PCP.CPR_CODIGO
    AND PCP.TD_CODIGO = TD.TD_CODIGO
    AND PCP.CC_CODIGO = C.CC_CODIGO
    AND TD.TD_CODIGO = :CODE_TIPO_DOC
    AND PCP_SITUACAO IN('A','L')
    ORDER BY
        C.CC_NOME
    INTO
        :CPR,
        :PCP,
        :CODE_EMP,
        :DATA_COMPRA,
        :DOCUMENTO,
        :VENCIMENTO,
        :VALOR,
        :CODE_DOC,
        :TIPO_DOC,
        :CUSTO
    DO
    BEGIN
      SELECT
          SUM(BCP_VALOR)
      FROM
          BAIXA_CONTA_PAGAR
      WHERE
          CPR_CODIGO = :CPR
      AND PCP_CODIGO = :PCP
      INTO
          :VALOR_PAGO;
      IF (VALOR_PAGO IS NULL) THEN
        VALOR_PAGO = 0;
      SALDO_DEVEDOR = VALOR - VALOR_PAGO;
      SUSPEND;
    END
END^

SET TERM ; ^
COMMIT;

ALTER TABLE ARTESANAL ADD ART_VALOR2 DOUBLE PRECISION;
ALTER TABLE SERVICO_ARTESANAL ADD OCOR_DESCRICAO  BLOB SUB_TYPE 0 SEGMENT SIZE 80;

COMMIT;
